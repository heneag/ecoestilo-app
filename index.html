<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>APP Generador de Publicación Instagram Eco Estilo</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        /* --- VARIABLES --- */
        :root {
            --rosa-principal: #ff69b4;
            --rosa-hover: #ff1493;
            --coral-principal: #ff7f50;
            --coral-hover: #ff4500;
            --verde-principal: #32cd32;
            --verde-hover: #28a428;
            --texto: #222;
        }
        
        /* --- ESTILOS GENERALES --- */
        body {
            font-family:'Poppins',sans-serif;
            display:flex;
            flex-direction:column;
            align-items:center;
            justify-content:flex-start;
            background: url('inicio.png') no-repeat center center fixed;
            background-size: cover;
            margin:0;
            min-height:100vh;
            padding: 16px;
            box-sizing: border-box;
        }
        
        body::before {
            content: "";
            position: fixed;
            inset: 0;
            background: rgba(255, 255, 255, 0);
            z-index:-1;
        }
        
        .pantalla {
            text-align:center;
            background:rgba(255, 255, 255, 0);
            backdrop-filter: blur(6px);
            padding:24px;
            border-radius:20px;
            box-shadow:0 10px 25px rgba(0,0,0,0.18);
            max-width:520px;
            width:100%;
            margin: 16px auto;
            box-sizing: border-box;
        }
        
        .pantalla h1 {
            color:#ff0482;
            margin:0 0 1px 0;
            font-weight:800;
            font-size: 1.5rem;
        }
        
        .pantalla h2 {
            color:#ff69b4;
            margin:0 0 1px 0;
            font-weight:800;
            font-size: 1.5rem;
        }
        
        .pantalla p {
            margin-bottom:18px;
            font-size:16px;
            color:#444;
        }
        
        input[type="text"], input[type="password"], select {
            width:100%;
            padding:12px 14px;
            margin:8px 0;
            border-radius:12px;
            border:1px solid #ccc;
            font-size:15px;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.08);
            transition: border .2s, box-shadow .2s;
            box-sizing: border-box;
        }
        
        input[type="text"]:focus, input[type="password"]:focus, select:focus {
            border-color: var(--rosa-principal);
            box-shadow: 0 0 8px rgba(255,105,180,0.4);
            outline:none;
        }
        
        button {
            padding:12px 20px;
            border:none;
            border-radius:12px;
            font-size:16px;
            font-weight:600;
            cursor:pointer;
            background:linear-gradient(45deg,#ff66b2,#66e0ff);
            color:white;
            transition:transform 0.25s, background 0.25s, box-shadow 0.25s;
            min-width: 120px;
        }
        
        button:hover {
            transform:translateY(-1px);
            background:linear-gradient(45deg,#ff3399,#33ccff);
            box-shadow: 0 6px 14px rgba(0,0,0,0.18);
        }
        
        #login, #app {
            display:none;
        }
        
        .login-img {
            width:70%;
            max-width:240px;
            margin:0 auto 16px auto;
            display:block;
            border-radius:12px;
            box-shadow:0 4px 12px rgba(0,0,0,0.15);
        }
        
        .controls {
            display:flex;
            flex-direction:column;
            gap:14px;
            width:100%;
            max-width:520px;
            background:rgba(255,255,255,0.9);
            backdrop-filter: blur(10px);
            padding:20px;
            border-radius:18px;
            box-shadow:0 10px 24px rgba(0,0,0,0.18);
            margin: 10px auto 14px auto;
            box-sizing: border-box;
        }
        
        .controls .grupo {
            display:flex;
            flex-direction:column;
            gap:8px;
            text-align:center; /* CENTRADO */
        }
        
        .controls label span, .controls .label-standalone {
            font-weight:600;
            color:var(--texto);
            font-size:15px;
            display:block;
        }
        
        /* input file y preview */
        .controls input[type="file"], .controls input[type="text"] {
            width:100%;
            padding:12px 14px;
            border-radius:12px;
            border:1px solid #ccc;
            font-size:15px;
            background:#fff;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.06);
            box-sizing: border-box;
        }
        
        .controls input[type="file"]::file-selector-button{
            margin-right: 10px;
            border:none;
            border-radius:10px;
            padding:8px 12px;
            font-weight:600;
            background: linear-gradient(45deg,#ff66b2,#66e0ff);
            color:#fff;
            cursor:pointer;
        }
        
        .controls input[type="file"]::file-selector-button:hover{
            background: linear-gradient(45deg,#ff3399,#33ccff);
        }
        
        .preview {
            width:120px;
            height:120px;
            object-fit:cover;
            border-radius:12px;
            border:2px solid #e8d6e0;
            display:none;
        }
        
        /* size buttons */
        .size-buttons {
            display:flex;
            flex-wrap:wrap;
            gap:8px;
            margin-top:2px;
        }
        
        .size-buttons button {
            padding:12px 12px;
            border:none;
            border-radius:12px;
            cursor:pointer;
            background:linear-gradient(45deg,#ff66b2,#66e0ff);
            color:white;
            font-weight:700;
            transition:transform 0.2s, filter 0.2s;
            flex: 1 1 calc(25% - 8px);
            min-width: 70px;
            font-size: 14px;
        }
        
        .size-buttons button:hover {
            transform:translateY(-1px);
            filter:brightness(1.05);
        }
        
        .size-buttons button.active {
            background:#ff33cc;
        }
        
        /* switch */
        .switch {
            position: relative;
            display: inline-block;
            width:60px;
            height:28px;
        }
        
        .switch input {
            display:none;
        }
        
        .slider {
            position:absolute;
            cursor:pointer;
            inset:0;
            background-color:#ccc;
            transition:0.3s;
            border-radius:28px;
        }
        
        .slider:before {
            content:"";
            position:absolute;
            height:22px;
            width:22px;
            left:3px;
            bottom:3px;
            background:#fff;
            transition:0.3s;
            border-radius:50%;
        }
        
        input:checked + .slider {
            background-color:#6666ff;
        }
        
        input:checked + .slider:before {
            transform:translateX(32px);
        }
        
        /* Contenedor de canvases */
        #contenedorCanvases{
            display:flex;
            gap:18px;
            flex-wrap:wrap;
            justify-content:center;
            margin: 8px auto 24px auto;
            width:100%;
            max-width:1020px;
        }
        
        canvas {
            border-radius:12px;
            border:2px solid #eee;
            box-shadow:0 6px 14px rgba(241,194,218,0.6);
            max-width:100%;
            height:auto;
        }
        
        /* --- BOTONES DE ACCIÓN --- */
        .fila-actions {
            display:flex;
            gap:10px;
            flex-wrap:nowrap;
            justify-content:space-between;
        }
        
        #generarAmbosBtn, #descargarFeedBtn, #descargarHistoriaBtn {
            flex: 1 1 32%;
            color:#fff;
            border-radius:12px;
            font-weight:800;
            margin: 0;
        }
        
        #generarAmbosBtn {
            background:var(--rosa-principal);
        }
        
        #generarAmbosBtn:hover {
            background:var(--rosa-hover);
        }
        
        #descargarFeedBtn {
            background:var(--verde-principal);
        }
        
        #descargarFeedBtn:hover {
            background:var(--verde-hover);
        }
        
        #descargarHistoriaBtn {
            background:var(--coral-principal);
        }
        
        #descargarHistoriaBtn:hover {
            background:var(--coral-hover);
        }
        
        /* --- RESPONSIVE --- */
        @media (max-width: 768px) {
            .fila-actions {
                flex-direction: column;
            }
            
            #generarAmbosBtn, #descargarFeedBtn, #descargarHistoriaBtn {
                width:100%;
                flex:unset;
                margin-bottom:6px;
            }
        }
        
        .titulo-label span {
            font-weight: 800; /* mismo peso que el h2 */
            color: #ff0080; /* mismo color que el h2 */
            font-size: 1.1rem; /* un poco más pequeño que h2 */
            display: block;
            margin-bottom: 6px; /* espacio entre el texto y el input */
            text-align: center; /* centrado como antes */
        }
        
        .titulo-label2 span {
            font-weight: 600; /* mismo peso que el h2 */
            color: #ff0080; /* mismo color que el h2 */
            font-size: 1rem; /* un poco más pequeño que h2 */
            display: block;
            margin-bottom: 8px; /* espacio entre el texto y el input */
            text-align: center; /* centrado como antes */
        }
        
        #codigo, #precio {
            width: 250px; /* Ancho del input */
            padding: 10px 15px; /* Espacio interno */
            border: 2px solid #ff0080; /* Borde rosa */
            border-radius: 12px; /* Bordes redondeados */
            font-size: 16px; /* Tamaño de letra */
            font-family: 'Poppins', sans-serif;
            outline: none; /* Quita borde por defecto al enfocar */
            transition: all 0.3s ease; /* Transición suave */
            box-shadow: 0 2px 5px rgba(0,0,0,0.1); /* Sombra suave */
        }
        
        #codigo::placeholder, #precio::placeholder {
            color: #c4709a; /* Color del placeholder */
            opacity: 0.7; /* Leve transparencia */
            font-style: italic; /* Cursiva para estilo */
        }
        
        #codigo:focus, #precio:focus {
            border-color: #6666ff; /* Cambia color del borde al enfocar */
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
        }
        
        .image-upload-container {
            display: flex;
            flex-direction: column;
            align-items: center; /* Centra todo horizontalmente */
            gap: 15px; /* Espacio entre input y preview */
            margin-top: 20px;
        }
        
        .custom-file-label {
            display: inline-block;
            padding: 10px 20px;
            background-color: #c4709a; /* Color rosa */
            color: #fff;
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            font-size: 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        
        .custom-file-label:hover {
            background-color: #ff85b5; /* Cambio al pasar el mouse */
        }
        
        .custom-file-label input {
            display: none; /* Oculta el input real */
        }
        
        .preview {
            width: 280px; /* Ancho de la imagen */
            max-width: 90%; /* Se adapta a móviles */
            height: 250px; /* Altura fija para consistencia */
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            object-fit: contain; /* Muestra toda la imagen sin recortar */
            background-color: #f5f5f5; /* Fondo suave para que se vea la imagen completa */
            padding: 5px; /* Espacio interno para que no toque los bordes */
        }
        
        /* Estilos para el selector de categoría y condición */
        select {
            width: 250px;
            padding: 10px 15px;
            border: 2px solid #ff0080;
            border-radius: 12px;
            font-size: 16px;
            font-family: 'Poppins', sans-serif;
            outline: none;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            background-color: white;
        }
        
        select:focus {
            border-color: #6666ff;
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
        }
        
        /* Estilo para ocultar elementos */
        .hidden {
            display: none !important;
        }
        
        /* Nuevos estilos para los campos de información */
        .info-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin: 15px 0;
            width: 100%;
        }
        
        .info-row {
            display: flex;
            justify-content: space-between;
            gap: 10px;
        }
        
        .info-item {
            flex: 1;
            min-width: 120px;
            text-align: center;
            padding: 10px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.8);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .info-label {
            font-weight: 800;
            font-size: 0.9rem;
            margin-bottom: 5px;
            display: block;
        }
        
        .info-value {
            font-weight: 600;
            font-size: 0.95rem;
            word-break: break-word;
        }
        
        /* Colores específicos para cada campo */
        .info-categoria .info-label {
            color: #6666ff;
        }
        
        .info-precio .info-label {
            color: #32cd32;
        }
        
        .info-condicion .info-label {
            color: #ff7f50;
        }
        
        .info-talla .info-label {
            color: #ff69b4;
        }
        
        /* Responsive para los campos de información */
        @media (max-width: 768px) {
            .info-row {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- LOGIN -->
    <div id="login" class="pantalla h1">
        <img src="logo.png" alt="Inicio" class="login-img">
        <h2>Hola Darksssss.....<br>Bienvenida a la App de Eco Estilo</h2>
        <input type="text" id="usuario" placeholder="Usuario">
        <input type="password" id="clave" placeholder="Contraseña">
        <button onclick="login()">Ingresar y Empezar</button>
        <p id="error" style="color:#d63031; display:none; margin-top:10px;">Usuario o contraseña incorrectos</p>
    </div>

    <!-- APP -->
    <div id="app" class="pantalla" style="max-width:1100px;">
        <h1 style="text-align:center; margin-bottom:10px;">Generador de Feed & Historia</h1>
        <div style="height:30px;"></div> <!-- separador -->

        <div class="image-upload-container">
            <label for="productoInput" class="custom-file-label">
                Selecciona una imagen
                <input type="file" id="productoInput" accept="image/*">
            </label>
            <img id="preview" class="preview" src="" alt="Vista previa">
        </div>

        <div class="titulo-label2">
            <label for="categoria"><span><br>Categoría</span></label>
            <select id="categoria" onchange="toggleTallas()">
                <option value="Dama">Dama</option>
                <option value="Caballero">Caballero</option>
                <option value="Niño">Niño</option>
                <option value="Niña">Niña</option>
                <option value="Juguete">Juguete</option>
                <option value="Accesorios">Accesorios</option>
                <option value="Bolsos y Mochilas">Bolsos y Mochilas</option>
                <option value="Otros">Otros</option>
            </select>
        </div>

        <div class="titulo-label2">
            <label for="codigo"><span><br>Código</span></label>
            <input type="text" id="codigo" placeholder="Ejemplo: ABC123">
        </div>

        <div class="titulo-label2">
            <label for="precio"><span><br>Precio</span></label>
            <input type="text" id="precio" placeholder="Ejemplo: ¢2500">
        </div>

        <div class="titulo-label2">
            <label for="condicion"><span><br>Condición</span></label>
            <select id="condicion">
                <option value="Nuevo">Nuevo</option>
                <option value="Usado A+">Usado A+</option>
                 <option value="Usado A">Usado A</option>
                <option value="Usado B">Usado B</option>
                <option value="Liquidacion">Liquidación</option>
            </select>
        </div>

        <div id="contenedorTallas" class="titulo-label2">
            <label for="codigo"><span><br>Escoja la Talla<br></span></label>
            <div class="size-buttons">
                <button onclick="selectSize(this,'1-2')">1-2</button>
                <button onclick="selectSize(this,'3-4')">3-4</button>
                <button onclick="selectSize(this,'5-6')">5-6</button>
                <button onclick="selectSize(this,'7-8')">7-8</button>
                <button onclick="selectSize(this,'9-10')">9-10</button>
                <button onclick="selectSize(this,'24')">12</button>
                <button onclick="selectSize(this,'26')">14</button>
                <button onclick="selectSize(this,'28')">16</button>
                <button onclick="selectSize(this,'24')">18</button>
                <button onclick="selectSize(this,'26')">20</button>
                <button onclick="selectSize(this,'28')">22</button>
                <button onclick="selectSize(this,'24')">24</button>
                <button onclick="selectSize(this,'26')">26</button>
                <button onclick="selectSize(this,'28')">28</button>
                <button onclick="selectSize(this,'30')">30</button>
                <button onclick="selectSize(this,'32')">32</button>
                <button onclick="selectSize(this,'34')">34</button>
                <button onclick="selectSize(this,'36')">36</button>
                <button onclick="selectSize(this,'38')">38</button>
                <button onclick="selectSize(this,'40')">40</button>
                <button onclick="selectSize(this,'41')">41</button>
                <button onclick="selectSize(this,'42')">42</button>
                <button onclick="selectSize(this,'43')">43</button>
                <button onclick="selectSize(this,'XS')">XS</button>
                <button onclick="selectSize(this,'S')">S</button>
                <button onclick="selectSize(this,'M')">M</button>
                <button onclick="selectSize(this,'L')">L</button>
                <button onclick="selectSize(this,'XL')">XL</button>
                <button onclick="selectSize(this,'2XL')">2XL</button>
                <button onclick="selectSize(this,'3XL')">3XL</button>
                <button onclick="selectSize(this,'Surtido')">Surtido</button>
            </div>
        </div>

        <br>

        <div class="titulo-label2" style="display:flex; align-items:center; justify-content:center; gap:10px;">
            <div style="color:#ff00e1; font-weight:600;">Marco</div>
            <label class="switch">
                <input type="checkbox" id="toggleMarco" checked>
                <span class="slider"></span>
            </label>
        </div>

        <!-- Botón para generar ambos -->
        <div class="fila-actions" style="margin-top: 20px;">
            <button id="generarAmbosBtn">Generar Feed + Historia</button>
        </div>

        <!-- Contenedor de los canvases -->
        <div id="contenedorCanvases">
            <!-- Contenedor del Feed -->
            <div class="contenedor-canvas">
                <div style="font-family: 'Poppins', sans-serif; color: #54f983; font-weight: 400; text-align: center; font-size: 1.5rem;"> Feed </div>
                <canvas id="canvasFeed" width="1080" height="1080"></canvas>
                <div class="fila-actions">
                    <button id="descargarFeedBtn">Descargar Feed</button>
                </div>
            </div>

            <!-- Contenedor de la Historia -->
            <div class="contenedor-canvas">
                <div style="font-family: 'Poppins', sans-serif; color: #e98e1e; font-weight: 400; text-align: center; font-size: 1.5rem;"> Historia </div>
                <canvas id="canvasHistoria" width="1080" height="1920"></canvas>
                <div class="fila-actions">
                    <button id="descargarHistoriaBtn">Descargar Historia</button>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <br>
        &copy; 2025 Todos los derechos reservados. <br>
        Hecho con carino y amor por<strong> ENG</strong> para <strong> Suana de La O</strong>
    </footer>

    <script>
        // Añadir función roundRect al CanvasRenderingContext2D si no existe
        if (!CanvasRenderingContext2D.prototype.roundRect) {
            CanvasRenderingContext2D.prototype.roundRect = function(x, y, width, height, radius) {
                if (width < 2 * radius) radius = width / 2;
                if (height < 2 * radius) radius = height / 2;
                this.beginPath();
                this.moveTo(x + radius, y);
                this.arcTo(x + width, y, x + width, y + height, radius);
                this.arcTo(x + width, y + height, x, y + height, radius);
                this.arcTo(x, y + height, x, y, radius);
                this.arcTo(x, y, x + width, y, radius);
                this.closePath();
                return this;
            };
        }

        // Mostrar login inicialmente
        document.getElementById("login").style.display = "block";
        
        function login(){
            const user = document.getElementById("usuario").value.trim();
            const pass = document.getElementById("clave").value.trim();
            const error = document.getElementById("error");
            
            // Credenciales - modificar según necesidad
            const USUARIO = "susana";
            const CLAVE = "ily";
            
            if(user === USUARIO && pass === CLAVE){
                document.getElementById("login").style.display = "none";
                document.getElementById("app").style.display = "block";
            } else {
                error.style.display = "block";
            }
        }
        
        /* Preview de imagen */
        const preview = document.getElementById("preview");
        const toggleMarco = document.getElementById("toggleMarco");
        let tallaSeleccionada = "";
        
        document.getElementById('productoInput').addEventListener("change", e=>{
            const file = e.target.files[0];
            if(file){
                const reader = new FileReader();
                reader.onload = event=>{
                    preview.src = event.target.result;
                    preview.style.display="block";
                };
                reader.readAsDataURL(file);
            }
        });
        
        /* Función para mostrar/ocultar tallas según categoría */
        function toggleTallas() {
            const categoria = document.getElementById("categoria").value;
            const contenedorTallas = document.getElementById("contenedorTallas");
            
            // Mostrar solo para categorías que requieren tallas
            if (categoria === "Dama" || categoria === "Caballero" || categoria === "Niño" || categoria === "Niña") {
                contenedorTallas.classList.remove("hidden");
            } else {
                contenedorTallas.classList.add("hidden");
                tallaSeleccionada = ""; // Limpiar talla seleccionada
                document.querySelectorAll(".size-buttons button").forEach(b => b.classList.remove("active"));
            }
        }
        
        /* Selección de talla */
        function selectSize(button,talla){
            document.querySelectorAll(".size-buttons button").forEach(b=>b.classList.remove("active"));
            button.classList.add("active");
            tallaSeleccionada = talla;
        }
        
        /* Dibujo de producto + textos */
        function dibujarProductoTexto(ctx, canvas, imgProducto){
            const maxH = canvas.height * 0.90;
            const maxW = canvas.width * 0.90;
            let scale = Math.min(maxW / imgProducto.width, maxH / imgProducto.height);
            
            if(canvas.width === 1080 && canvas.height === 1080){
                scale *= 0.90;
            }
            
            const w = imgProducto.width * scale;
            const h = imgProducto.height * scale;
            const x = (canvas.width - w) / 2;
            
            // Ajuste diferente para feed vs historia
            let y;
            if (canvas.width === 1080 && canvas.height === 1080) {
                // Para FEED: menos desplazamiento hacia arriba
                y = (canvas.height - h) / 2 - canvas.height * 0.06;
            } else if (canvas.width === 1080 && canvas.height === 1920) {
                // Para HISTORIA: centrado vertical con pequeño ajuste
                y = (canvas.height - h) / 2 - canvas.height * 0.05;
            } else {
                // Para otros casos (por si acaso)
                y = (canvas.height - h) / 2;
            }
            
            /* Marco blanco con sombra (opcional) */
            if(toggleMarco.checked){
                const radius = 22, marco = 14;
                ctx.save();
                ctx.fillStyle = "#ffffff";
                ctx.shadowColor = "rgba(0,0,0,0.2)";
                ctx.shadowBlur = 26;
                ctx.shadowOffsetX = 8;
                ctx.shadowOffsetY = 8;
                
                ctx.beginPath();
                ctx.moveTo(x - marco + radius, y - marco);
                ctx.lineTo(x + w + marco - radius, y - marco);
                ctx.quadraticCurveTo(x + w + marco, y - marco, x + w + marco, y - marco + radius);
                ctx.lineTo(x + w + marco, y + h + marco - radius);
                ctx.quadraticCurveTo(x + w + marco, y + h + marco, x + w + marco - radius, y + h + marco);
                ctx.lineTo(x - marco + radius, y + h + marco);
                ctx.quadraticCurveTo(x - marco, y + h + marco, x - marco, y + h + marco - radius);
                ctx.lineTo(x - marco, y - marco + radius);
                ctx.quadraticCurveTo(x - marco, y - marco, x - marco + radius, y - marco);
                ctx.closePath();
                ctx.fill();
                ctx.restore();
            }
            
            /* Recorte redondeado y producto */
            const radius = 22;
            ctx.save();
            ctx.beginPath();
            ctx.moveTo(x + radius, y);
            ctx.lineTo(x + w - radius, y);
            ctx.quadraticCurveTo(x + w, y, x + w, y + radius);
            ctx.lineTo(x + w, y + h - radius);
            ctx.quadraticCurveTo(x + w, y + h, x + w - radius, y + h);
            ctx.lineTo(x + radius, y + h);
            ctx.quadraticCurveTo(x, y + h, x, y + h - radius);
            ctx.lineTo(x, y + radius);
            ctx.quadraticCurveTo(x, y, x + radius, y);
            ctx.closePath();
            ctx.clip();
            ctx.drawImage(imgProducto, x, y, w, h);
            ctx.restore();
            
            // Definir dimensiones de la caja de información
            const boxMarginX = canvas.width * 0.05;
            const boxMarginY = canvas.height * 0.75;
            const boxWidth = canvas.width * 0.9;
            const boxHeight = canvas.height * 0.2;
            
            // === CAJA DE INFORMACIÓN ===
            ctx.fillStyle = "rgba(255, 255, 255, 0.85)";
            ctx.beginPath();
            ctx.roundRect(boxMarginX, boxMarginY, boxWidth, boxHeight, 20);
            ctx.fill();
            
            ctx.textAlign = "center";
            ctx.textBaseline = "middle";
            
            // Coordenadas dentro de la caja
            const primeraFilaY = boxMarginY + boxHeight * 0.33;
            const segundaFilaY = boxMarginY + boxHeight * 0.72;
            
            // Sombra de texto
            ctx.shadowColor = "rgba(0,0,0,0.4)";
            ctx.shadowBlur = 6;
            
            // === AJUSTE DINÁMICO DE FUENTES ===
            let precioFontSize, otrosFontSize, codigoFontSize;
            if (canvas.height === 1080) {
                // Feed
                precioFontSize = Math.round(canvas.height * 0.04);
                otrosFontSize = Math.round(canvas.height * 0.032);
                codigoFontSize = Math.round(canvas.height * 0.012);
            } else if (canvas.height === 1920) {
                // Historia
                precioFontSize = Math.round(canvas.height * 0.025);
                otrosFontSize = Math.round(canvas.height * 0.018);
                codigoFontSize = Math.round(canvas.height * 0.010);
            } else {
                precioFontSize = Math.round(canvas.height * 0.035);
                otrosFontSize = Math.round(canvas.height * 0.025);
                codigoFontSize = Math.round(canvas.height * 0.012);
            }
            
            // === PRECIO ===
            ctx.font = `900 ${precioFontSize}px Poppins`;
            ctx.fillStyle = "#32cd32";
            ctx.fillText(
                "Precio: ¢" + document.getElementById("precio").value.trim(),
                canvas.width * 0.25,
                primeraFilaY
            );
            
            // === TALLA ===
            if (tallaSeleccionada) {
                ctx.fillStyle = "#ff69b4";
                ctx.fillText(
                    "Talla: " + tallaSeleccionada,
                    canvas.width * 0.75,
                    primeraFilaY
                );
            }
            
            // === CATEGORÍA ===
            ctx.font = `700 ${otrosFontSize}px Poppins`;
            ctx.fillStyle = "#6666ff";
            ctx.fillText(
                "Categoría: " + document.getElementById("categoria").value,
                canvas.width * 0.25,
                segundaFilaY
            );
            
            // === CONDICIÓN ===
            ctx.fillStyle = "#ff7f50";
            ctx.fillText(
                "Condición: " + document.getElementById("condicion").value,
                canvas.width * 0.75,
                segundaFilaY
            );
            
            // Reset de sombra
            ctx.shadowBlur = 0;
            
            /* Código en esquina superior izquierda */
            ctx.save();
            ctx.font = `bold ${codigoFontSize}px Poppins`;
            ctx.fillStyle = "pink";
            ctx.textAlign = "left";
            ctx.textBaseline = "top";
            let codigoTexto = document.getElementById('codigo').value.trim();
            ctx.fillText("Código", 30, 35);
            ctx.fillText(codigoTexto, 30, 55);
            ctx.restore();
        }
        
        /* Dibuja fondo + contenido */
        function dibujarCanvas(ctx, canvas, imgProducto, fondoSrc, width, height){
            canvas.width = width;
            canvas.height = height;
            
            const fondo = new Image();
            fondo.src = fondoSrc;
            fondo.onload = ()=> {
                ctx.drawImage(fondo,0,0,canvas.width,canvas.height);
                dibujarProductoTexto(ctx, canvas, imgProducto);
            };
            fondo.onerror = ()=> {
                ctx.fillStyle = "#ffffff";
                ctx.fillRect(0,0,canvas.width,canvas.height);
                dibujarProductoTexto(ctx, canvas, imgProducto);
            };
        }
        
        /* Validación */
        function validarCampos(){
            if(!document.getElementById('productoInput').files[0]) {
                alert("Suba una imagen del producto");
                return false;
            }
            
            const categoria = document.getElementById('categoria').value;
            if(categoria === "Dama" || categoria === "Caballero" || categoria === "Niño" || categoria === "Niña") {
                if(!tallaSeleccionada) {
                    alert("Seleccione una talla");
                    return false;
                }
            }
            
            if(!document.getElementById('codigo').value.trim()) {
                alert("Ingrese un código");
                return false;
            }
            
            if(!document.getElementById('precio').value.trim()) {
                alert("Ingrese un precio");
                return false;
            }
            
            return true;
        }
        
        /* Generar ambos (Feed + Historia) */
        function generarAmbos(){
            if(!validarCampos()) return;
            
            const fileInput = document.getElementById('productoInput');
            const reader = new FileReader();
            
            reader.onload = e=>{
                const img = new Image();
                img.onload = ()=> {
                    dibujarCanvas(
                        document.getElementById('canvasFeed').getContext('2d'),
                        document.getElementById('canvasFeed'),
                        img,
                        './fondo.png',
                        1080,
                        1080
                    );
                    
                    dibujarCanvas(
                        document.getElementById('canvasHistoria').getContext('2d'),
                        document.getElementById('canvasHistoria'),
                        img,
                        './fondo2.png',
                        1080,
                        1920
                    );
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(fileInput.files[0]);
        }
        
        /* Descargar Feed */
        function descargarFeed(){
            if(!validarCampos()) return;
            
            const codigo = document.getElementById('codigo').value.trim();
            const fecha = new Date();
            const fechaStr = fecha.getFullYear() + ('0'+(fecha.getMonth()+1)).slice(-2) + ('0'+fecha.getDate()).slice(-2);
            
            const linkFeed = document.createElement('a');
            linkFeed.download = `FEED_${tallaSeleccionada}_${codigo}_${fechaStr}.png`;
            linkFeed.href = document.getElementById('canvasFeed').toDataURL('image/png');
            linkFeed.click();
        }
        
        /* Descargar Historia */
        function descargarHistoria(){
            if(!validarCampos()) return;
            
            const codigo = document.getElementById('codigo').value.trim();
            const fecha = new Date();
            const fechaStr = fecha.getFullYear() + ('0'+(fecha.getMonth()+1)).slice(-2) + ('0'+fecha.getDate()).slice(-2);
            
            const linkHistoria = document.createElement('a');
            linkHistoria.download = `HISTORIA_${tallaSeleccionada}_${codigo}_${fechaStr}.png`;
            linkHistoria.href = document.getElementById('canvasHistoria').toDataURL('image/png');
            linkHistoria.click();
        }
        
        /* Listeners */
        document.getElementById('generarAmbosBtn').addEventListener('click', generarAmbos);
        document.getElementById('descargarFeedBtn').addEventListener('click', descargarFeed);
        document.getElementById('descargarHistoriaBtn').addEventListener('click', descargarHistoria);
        
        // Inicializar estado de las tallas
        toggleTallas();
    </script>
</body>
</html>